<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>TO OUR SHARED : SEARCH</title>

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Mansalva|Nanum+Gothic|Nanum+Myeongjo|Noto+Sans+KR|Lora|East+Sea+Dokdo|Jua&display=swap" rel="stylesheet">

    <!-- ICON -->
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <!-- JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }


        .modal-cost, .travelRoute {
            top: 0;
            margin-top: 28px;
            padding-right: 127px;
            display: flex;
            flex-direction: row-reverse;
            width: 100%;
            position: absolute;
        }

        .modal-cost-area {
            width: 300px;
            height: 700px;
            border: 1px solid rgba(0, 0, 0, 0.6);
            background-color: #eee;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
        }

        .cost-header {
            cursor: default;
            width: 100%;
            height: 80px;
            padding: 10px;
            background-color: #e2e2e2;
            border-top-left-radius: 4px;
            border-top-right-radius: 4px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;

        }

        .cost-header .chTitle {
            font-size: 23px;
            font-weight: 700;
        }

        .cost-header .chBody {
            font-size: 15px;
        }

        .cost-body {
            width: 100%;
            height: 100%px;
            padding: 0px 10px 10px;
            overflow: auto;
        }

        .costItem {
            cursor: default;
            padding: 10px 0 5px;
            border-bottom: 1px dashed rgba(0, 0, 0, 0.2);
        }

        .costItem-header span {
            font-size: 40px;
            font-family: 'East Sea Dokdo', cursive;
        }

        .costItem-body ul {
            padding: 0 5px 0 20px;
            list-style-type: circle;
        }

        .costItem-body li {
            font-size: 12px;
        }
    </style>

</head>

<body>


    <!-- costModal -->
    <div class="modal-cost">
        <div class="modal-cost-area">
            <div class="cost-header" id="costHeader">
                <span class="chTitle">Ï†ÑÏ≤¥ Í≤ΩÎπÑ</span>
                <span class="chBody">üí∞ 290,000</span>
            </div>
            <div class="cost-body" id="costBody">
                <div class="costItem">
                    <div class="costItem-header">
                        <span># 1Ïùº Ïß∏</span>
                    </div>
                    <div class="costItem-body">
                        <ul>
                            <li>ÏãùÎπÑ 18,000</li>
                            <li>ÏáºÌïë 40,000</li>
                        </ul>
                    </div>
                </div>
                <div class="costItem">
                    <div class="costItem-header">
                        <span># 2Ïùº Ïß∏</span>
                    </div>
                    <div class="costItem-body">
                        <ul>
                            <li>ÏãùÎπÑ 18,000</li>
                            <li>ÏáºÌïë 40,000</li>
                        </ul>
                    </div>
                </div>
                <div class="costItem">
                    <div class="costItem-header">
                        <span># 3Ïùº Ïß∏</span>
                    </div>
                    <div class="costItem-body">
                        <ul>
                            <li>ÏãùÎπÑ 18,000</li>
                            <li>ÏáºÌïë 40,000</li>
                        </ul>
                    </div>
                </div>
                <div class="costItem">
                    <div class="costItem-header">
                        <span># 4Ïùº Ïß∏</span>
                    </div>
                    <div class="costItem-body">
                        <ul>
                            <li>ÏãùÎπÑ 18,000</li>
                            <li>ÏáºÌïë 40,000</li>
                        </ul>
                    </div>
                </div>
                <div class="costItem">
                    <div class="costItem-header">
                        <span># 5Ïùº Ïß∏</span>
                    </div>
                    <div class="costItem-body">
                        <ul>
                            <li>ÏãùÎπÑ 18,000</li>
                            <li>ÏáºÌïë 40,000</li>
                        </ul>
                    </div>
                </div>
                <div class="costItem">
                    <div class="costItem-header">
                        <span># 6Ïùº Ïß∏</span>
                    </div>
                    <div class="costItem-body">
                        <ul>
                            <li>ÏãùÎπÑ 18,000</li>
                            <li>ÏáºÌïë 40,000</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div style="padding-top: 800px">
        <textarea rows="1" resizable="false"></textarea>
        <div class="btn btn-secondary" onclick="refreashCostItem()">Ï∂îÍ∞Ä</div>

    </div>

    

    <script>
        
        
        //------------------------------------
        //----------CostItems and CostItemList Start
        //------------------------------------
        class CostItem {
            constructor(place_name) {
                this.itemList = Array();
                this.place_name = place_name;
            }
            setPlace_name(place_name) {
                this.place_name = place_name;
            }
            pushItem(costType, cost, info) {
                this.itemList.push({
                    costType,
                    cost,
                    info
                });
            }
            popItem() {
                this.itemList.pop();
            }
        }

        var CostItemList = Array();

        console.info(CostItemList);
        console.info(CostItemList);

        console.info(CostItemList);

        function button() {

        }


        function refreashCostItem() {

            var costBody = document.getElementById('costBody'),
                costHeader = document.getElementById('costHeader'),
                fragment = document.createDocumentFragment(),
                headerFragment = document.createDocumentFragment(),
                itemList = '',
                el, headerEl,totalCost = 0,
                pindexTmp;
            
             ;

            // costBody Î™®Îì† ÏûêÏãù ÎÖ∏Îìú ÏÇ≠Ï†ú
            while (costBody.hasChildNodes()) {
                costBody.removeChild(costBody.firstChild);
            }
            CostItemList.forEach(function(currentValue, pindex) {
                pindexTmp = pindex;
                console.info(pindex);
                console.info(currentValue);
                el = document.createElement('div'),
                    itemStr =

                    '<div class="costItem-header">' +
                    '   <div class="form-group">' +
                    '       <table><tr>' +
                    '           <td>' +
                    '               <input id="addCost_place_name_' + pindex + '" class="form-control form-control-sm" type="text" placeholder="Ïû•ÏÜå Ïù¥Î¶Ñ" value="' + currentValue.place_name + '"  style="width:140px;" />' +
                    '           </td>' +
                    '           <td>' +
                    '               <div class="btn btn-secondary btn-sm" onclick="setCostItemParentName(' + pindex + ')" >Ïù¥Î¶ÑÎ≥ÄÍ≤Ω</div>' +
                    '           </td>' +
                    '           <td>' +
                    '               <div class="btn btn-danger btn-sm" onclick="removeCostItemParent(' + pindex + ')"> x </div>' +
                    '           </td>' +
                    '       </tr></table>' +
                    '   </div>' +
                    //'         <span># ' + (index + 1) + 'Ïùº Ïß∏</span>' +
                    '</div>' +
                    '   <div class="costItem-body">' +
                    '       <ul>';

                currentValue.itemList.forEach(function(currentValue, index) {
                    itemStr += '<li>' + currentValue.costType + '<br/>' + setComa(currentValue.cost) + ' (' + currentValue.info + ')' + '</li>';
                    totalCost += parseInt(currentValue.cost);
                });

                itemStr +=
                    '           <li>' +
                    '               <select id="addCost_costType_' + pindex + '" class="form-control form-control-sm">' +
                    '                   <option value="ÏãùÎπÑ">ÏãùÎπÑ</option>' +
                    '                   <option value="ÍµêÌÜµÎπÑ">ÍµêÌÜµÎπÑ</option>' +
                    '                   <option value="ÏàôÎ∞ïÎπÑ">ÏàôÎ∞ïÎπÑ</option>' +
                    '                   <option value="Í∏∞ÌÉÄ">Í∏∞ÌÉÄ</option>' +
                    '               </select>' +
                    '               <input id="addCost_cost_' + pindex + '" class="form-control form-control-sm" type="number" placeholder="ÎπÑÏö©">' +
                    '               <input id="addCost_info_' + pindex + '" class="form-control form-control-sm" type="text" placeholder="ÎπÑÏö© ÏÑ§Î™Ö">' +
                    '               <div class="btn btn-secondary btn-sm" onclick="pushCostItemChild(' + pindex + ')">+</div>' +
                    '               <div class="btn btn-secondary btn-sm" onclick="popCostItemChild(' + pindex + ')">-</div>' +
                    '           </li>' +
                    '   </ul>' +
                    '</div>';
                el.innerHTML = itemStr;
                //            el.setAttribute("draggable", 'true');
                //            el.setAttribute("id", "travelPoint");
                el.setAttribute("class", "costItem");


                var itemEl = el;

                fragment.appendChild(itemEl);

                costBody.appendChild(fragment);



            });

            // ÎÇòÏ§ëÏóê ÏßÄÎèÑÏùò travelrouteÏóêÏÑú Ï∂îÍ∞ÄÌï† Î≤ÑÌäº
            el = document.createElement('div'),
                itemStr =

                '<div class="btn btn-secondary btn-sm" onclick="addCostItemParent(' + pindexTmp + ')">+</div>';

            el.innerHTML = itemStr;
            //            el.setAttribute("draggable", 'true');
            //            el.setAttribute("id", "travelPoint");
            el.setAttribute("class", "costItem");


            var itemEl = el;

            fragment.appendChild(itemEl);

            costBody.appendChild(fragment);

            //--------------------



            var headerStr =
                '<span class="chTitle">Ï†ÑÏ≤¥ Í≤ΩÎπÑ</span>' +
                '<span class="chBody">üí∞ ' + setComa(totalCost) + '</span>';
            costHeader.innerHTML = headerStr;




        }

        function pushCostItemChild(index) {

            var costTypeId = "addCost_costType_" + index,
                costId = "addCost_cost_" + index,
                infoId = "addCost_info_" + index;

            var costType = document.getElementById(costTypeId);
            cost = document.getElementById(costId),
                info = document.getElementById(infoId);

            CostItemList[index].pushItem(costType.options[costType.selectedIndex].value, cost.value, info.value);

            refreashCostItem();

        }


        function popCostItemChild(index) {

            var costTypeId = "addCost_costType_" + index,
                costId = "addCost_cost_" + index,
                infoId = "addCost_info_" + index;

            var costType = document.getElementById(costTypeId);
            cost = document.getElementById(costId),
                info = document.getElementById(infoId);

            CostItemList[index].popItem();
            refreashCostItem();

        }



        // ÎÇòÏ§ëÏóê Ïù∏Ìè¨ÏúàÎèÑÏö∞Ïóê Ï∂îÍ∞ÄÌïòÍ∏∞
        function addCostItemParent(place_name) {
            CostItemList.push(new CostItem("ÏïºÌò∏"));
            refreashCostItem();

        }

        function setCostItemParentName(pindex) {

            var addCost_place_nameId = "addCost_place_name_" + pindex;
            var addCost_place_name = document.getElementById(addCost_place_nameId);


            CostItemList[pindex].setPlace_name(addCost_place_name.value);
            refreashCostItem();
        }


        function removeCostItemParent(pindex) {
            CostItemList.splice(pindex, 1);
            refreashCostItem();
        }


        function setComa(number) {
            var resultStr = "";
            var strNumber = String(number);
            console.info(strNumber);
            console.info(strNumber.length);
            for (var i = strNumber.length - 1; i >= 0; i--) {
                console.info(i);

                if ((strNumber.length - i - 1) % 3 == 0 && i != strNumber.length - 1) {
                    resultStr = ',' + resultStr;
                }
                resultStr = strNumber[i] + resultStr;
            }
            

            return resultStr;

        }
        
        //------------------------------------
        //----------CostItems and CostItemList End
        //------------------------------------
        
        
        console.info(setComa(100000000000000000));
    </script>
</body></html>